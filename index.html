<!DOCTYPE html><!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Proje Takip Sistemi</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      display: flex;
      height: 100vh;
      background: #f2f4f8;
    }
    header {
      position: fixed;
      top: 0; left: 0; right: 0;
      background: #1e3a8a;
      color: white;
      text-align: center;
      padding: 12px;
      font-size: 20px;
      font-weight: bold;
      z-index: 1000;
    }
    #form-panel {
      width: 350px;
      background: #fff;
      padding: 20px;
      box-shadow: -2px 0 5px rgba(0,0,0,0.1);
      margin-left: auto;
      margin-top: 60px;
      overflow-y: auto;
    }
    #projects {
      flex: 1;
      padding: 80px 20px 20px 20px;
      overflow-y: auto;
    }
    .project-card {
      background: white;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .project-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .profile {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .avatar {
      width: 28px; height: 28px;
      border-radius: 50%;
    }
    button {
      background: #1e3a8a;
      color: white;
      border: none;
      padding: 6px 10px;
      border-radius: 5px;
      cursor: pointer;
    }
    .details {
      display: none;
      margin-top: 10px;
      border-top: 1px solid #ddd;
      padding-top: 10px;
    }
    .note {
      font-size: 14px;
      background: #f9f9f9;
      margin: 5px 0;
      padding: 5px;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <header> <img src="logo.png" height="25">üìå Proje Takip Sistemi</header>

  <div id="projects"></div>

  <div id="form-panel">
    <h3>Yeni Proje Ekle</h3>
    <input id="title" placeholder="Proje Ba≈ülƒ±ƒüƒ±" style="width:100%;margin:5px 0;"><br>
    <textarea id="description" placeholder="Proje A√ßƒ±klamasƒ±" style="width:100%;margin:5px 0;"></textarea><br>
    <label>Ba≈ülangƒ±√ß Tarihi</label>
    <input type="date" id="startDate" style="width:100%;margin:5px 0;">
    <label>Biti≈ü Tarihi</label>
    <input type="date" id="endDate" style="width:100%;margin:5px 0;">
    <input id="proposal" placeholder="Teklif Linki" style="width:100%;margin:5px 0;">
    <input id="invoice" placeholder="Fatura Linki" style="width:100%;margin:5px 0;">
    <select id="type" style="width:100%;margin:5px 0;">
      <option value="3D Tasarƒ±m">3D Tasarƒ±m</option>
      <option value="Tersine M√ºhendislik">Tersine M√ºhendislik</option>
      <option value="Prototipleme">Prototipleme</option>
    </select>
    <input id="addedBy" placeholder="Ekleyen Ki≈üi" style="width:100%;margin:5px 0;">
    <button onclick="addProject()">Kaydet</button>
  </div>

  <script>
    // Firebase config buraya kendi config'ini koy
    const firebaseConfig = {
        apiKey: "AIzaSyCxwXtrXxHbC_LcIlbK_PRIQ4v5pXt1l6w",
        authDomain: "atolye1886projectmanagement.firebaseapp.com",
        databaseURL: "https://atolye1886projectmanagement-default-rtdb.firebaseio.com",
        projectId: "atolye1886projectmanagement",
        storageBucket: "atolye1886projectmanagement.firebasestorage.app",
        messagingSenderId: "852948318375",
        appId: "1:852948318375:web:609dd6544580d7d6430382"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Rastgele renk avatar
    function randomColor() {
      const colors = ["#ef4444","#f59e0b","#10b981","#3b82f6","#8b5cf6","#ec4899"];
      return colors[Math.floor(Math.random()*colors.length)];
    }

    function addProject() {
      const project = {
        title: document.getElementById("title").value,
        description: document.getElementById("description").value,
        startDate: document.getElementById("startDate").value,
        endDate: document.getElementById("endDate").value,
        proposal: document.getElementById("proposal").value,
        invoice: document.getElementById("invoice").value,
        type: document.getElementById("type").value,
        addedBy: document.getElementById("addedBy").value,
        avatarColor: randomColor(),
        createdAt: Date.now(),
        notes: {}
      };
      db.ref("projects").push(project);
      document.querySelectorAll("#form-panel input, #form-panel textarea").forEach(el=>el.value="");
    }

    function renderProjects(snapshot) {
      const projectsDiv = document.getElementById("projects");
      projectsDiv.innerHTML = "";
      let projects = [];
      snapshot.forEach(child => {
        projects.push({ id: child.key, ...child.val() });
      });
      projects.sort((a,b)=>b.createdAt - a.createdAt);
      projects.forEach(p=>{
        const card = document.createElement("div");
        card.className = "project-card";
        card.innerHTML = `
          <div class="project-header">
            <div class="profile">
              <div class="avatar" style="background:${p.avatarColor}"></div>
              <strong>${p.addedBy}</strong>
            </div>
            <button onclick="toggleDetails('${p.id}')">Detaylar</button>
          </div>
          <h4>${p.title}</h4>
          <div class="details" id="details-${p.id}">
            <p><b>A√ßƒ±klama:</b> ${p.description}</p>
            <p><b>T√ºr:</b> ${p.type}</p>
            <p><b>Ba≈ülangƒ±√ß:</b> ${p.startDate} | <b>Biti≈ü:</b> ${p.endDate}</p>
            <p><b>Teklif:</b> <a href="${p.proposal}" target="_blank">Link</a></p>
            <p><b>Fatura:</b> <a href="${p.invoice}" target="_blank">Link</a></p>
            <div id="notes-${p.id}"></div>
            <input id="noteInput-${p.id}" placeholder="Not ekle..." style="width:70%">
            <button onclick="addNote('${p.id}')">Ekle</button>
            <button onclick="deleteProject('${p.id}')">‚ùå Sil</button>
          </div>
        `;
        if (p.notes) {
          Object.values(p.notes).forEach(n=>{
            const noteDiv = document.createElement("div");
            noteDiv.className="note";
            noteDiv.innerText=`${n.date} - ${n.text}`;
            card.querySelector(`#notes-${p.id}`).appendChild(noteDiv);
          });
        }
        projectsDiv.appendChild(card);
      });
    }

    function toggleDetails(id) {
      const d = document.getElementById(`details-${id}`);
      d.style.display = (d.style.display==="block"?"none":"block");
    }

    function addNote(id) {
      const input = document.getElementById(`noteInput-${id}`);
      const text = input.value;
      if (!text) return;
      const note = { text, date: new Date().toLocaleString() };
      db.ref("projects/"+id+"/notes").push(note);
      input.value="";
    }

    function deleteProject(id) {
      if (confirm("Bu projeyi silmek istediƒüine emin misin?")) {
        db.ref("projects/"+id).remove();
      }
    }

    db.ref("projects").on("value", renderProjects);
  </script>
</body>
</html>



