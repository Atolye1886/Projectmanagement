<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Proje Takip Sistemi</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #f5f5f5;
      color: #333;
    }

    header {
      background: #000;
      color: white;
      padding: 20px;
      font-size: 22px;
      font-weight: bold;
      text-align: center;
    }

    .container {
      display: flex;
      flex-direction: row;
      gap: 20px;
      padding: 20px;
    }

    /* SOL TARAF - Proje Listesi */
    .projects {
      flex: 3;
    }

    .project-card {
      background: white;
      padding: 16px;
      margin-bottom: 16px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .project-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.25);
    }

    .project-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .project-header h3 {
      margin: 0;
    }

    .details-btn {
      background: #000;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 8px;
      cursor: pointer;
    }

    .project-details {
      margin-top: 12px;
      padding: 12px;
      border-top: 2px solid #000;
      background: #fafafa;
      display: none;
    }

    .project-details.open {
      display: block;
    }

    .note {
      margin-top: 6px;
      padding: 8px;
      background: #eee;
      border-radius: 6px;
      font-size: 14px;
    }

    /* SAƒû TARAF - Giri≈ü Paneli */
    .form-panel {
      flex: 1;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .form-panel input, .form-panel textarea {
      width: 100%;
      margin-bottom: 12px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }

    .form-panel button {
      background: #000;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      width: 100%;
    }

    .profile-icon {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 6px;
    }
  </style>
</head>
<body>
  <header>üìå Proje Takip Sistemi</header>

  <div class="container">
    <!-- SOL TARAF -->
    <div class="projects" id="projects"></div>

    <!-- SAƒû TARAF -->
    <div class="form-panel">
      <h3>Yeni Proje Ekle</h3>
      <input type="text" id="title" placeholder="Proje Ba≈ülƒ±ƒüƒ±" required />
      <textarea id="description" placeholder="Proje A√ßƒ±klamasƒ±"></textarea>
      <input type="date" id="startDate" placeholder="Ba≈ülangƒ±√ß Tarihi" />
      <input type="date" id="endDate" placeholder="Biti≈ü Tarihi" />
      <input type="text" id="owner" placeholder="Giri≈üi Yapan Ki≈üi" required />
      <input type="url" id="offerLink" placeholder="Teklif Linki (opsiyonel)" />
      <input type="url" id="invoiceLink" placeholder="Fatura Linki (opsiyonel)" />
      <input type="text" id="purchaseInfo" placeholder="Satƒ±n Alma Bilgisi (opsiyonel)" />
      <button onclick="addProject()">Ekle</button>
    </div>
  </div>

  <script>
    // Firebase ayarlarƒ± (kendi config‚Äôinizi buraya koyacaksƒ±nƒ±z!)
    const firebaseConfig = {
        apiKey: "AIzaSyCxwXtrXxHbC_LcIlbK_PRIQ4v5pXt1l6w",
        authDomain: "atolye1886projectmanagement.firebaseapp.com",
        databaseURL: "https://atolye1886projectmanagement-default-rtdb.firebaseio.com",
        projectId: "atolye1886projectmanagement",
        storageBucket: "atolye1886projectmanagement.firebasestorage.app",
        messagingSenderId: "852948318375",
        appId: "1:852948318375:web:609dd6544580d7d6430382"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Renk paleti (profil ikonu i√ßin)
    const colors = ["#f44336", "#3f51b5", "#009688", "#ff9800", "#9c27b0", "#2196f3"];

    function addProject() {
      const title = document.getElementById("title").value;
      const description = document.getElementById("description").value;
      const startDate = document.getElementById("startDate").value;
      const endDate = document.getElementById("endDate").value;
      const owner = document.getElementById("owner").value;
      const offerLink = document.getElementById("offerLink").value;
      const invoiceLink = document.getElementById("invoiceLink").value;
      const purchaseInfo = document.getElementById("purchaseInfo").value;

      if (!title || !owner) return alert("Ba≈ülƒ±k ve ki≈üi adƒ± zorunlu!");

      const color = colors[Math.floor(Math.random() * colors.length)];
      const projectRef = db.ref("projects").push();
      projectRef.set({
        title, description, startDate, endDate, owner, color,
        offerLink, invoiceLink, purchaseInfo,
        notes: [],
        createdAt: Date.now()
      });

      document.querySelectorAll(".form-panel input, .form-panel textarea").forEach(el => el.value = "");
    }

    // Projeleri √ßek ve listele
    db.ref("projects").orderByChild("createdAt").on("value", snapshot => {
      const container = document.getElementById("projects");
      container.innerHTML = "";
      snapshot.forEach(child => {
        const proj = child.val();
        const id = child.key;

        const card = document.createElement("div");
        card.className = "project-card";
        card.innerHTML = `
          <div class="project-header">
            <h3>${proj.title}</h3>
            <button class="details-btn" onclick="toggleDetails('${id}')">Detaylar</button>
          </div>
          <div class="project-details" id="details-${id}">
            <p><strong>A√ßƒ±klama:</strong> ${proj.description || "-"}</p>
            <p><strong>Ba≈ülangƒ±√ß:</strong> ${proj.startDate || "-"} | <strong>Biti≈ü:</strong> ${proj.endDate || "-"}</p>
            <p><span class="profile-icon" style="background:${proj.color}"></span> ${proj.owner}</p>
            ${proj.offerLink ? `<p>üìë <a href="${proj.offerLink}" target="_blank">Teklif</a></p>` : ""}
            ${proj.invoiceLink ? `<p>üßæ <a href="${proj.invoiceLink}" target="_blank">Fatura</a></p>` : ""}
            ${proj.purchaseInfo ? `<p>üí≥ ${proj.purchaseInfo}</p>` : ""}
            <h4>Notlar</h4>
            <div id="notes-${id}">
              ${(proj.notes || []).map(n => `<div class="note">üóí ${n.text} <br><small>${n.date}</small></div>`).join("")}
            </div>
            <input type="text" placeholder="Not ekle..." id="noteInput-${id}" />
            <button onclick="addNote('${id}')">Not Ekle</button>
            <br><br>
            <button style="background:red" onclick="deleteProject('${id}')">‚ùå Projeyi Sil</button>
          </div>
        `;
        container.prepend(card);
      });
    });

    function toggleDetails(id) {
      document.getElementById("details-" + id).classList.toggle("open");
    }

    function addNote(id) {
      const input = document.getElementById("noteInput-" + id);
      const text = input.value;
      if (!text) return;
      const note = { text, date: new Date().toLocaleString() };
      db.ref("projects/" + id + "/notes").push(note);
      input.value = "";
    }

    function deleteProject(id) {
      if (confirm("Bu projeyi silmek istediƒüinize emin misiniz?")) {
        db.ref("projects/" + id).remove();
      }
    }
  </script>
</body>
</html>
